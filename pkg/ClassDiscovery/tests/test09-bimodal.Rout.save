
R version 3.0.2 (2013-09-25) -- "Frisbee Sailing"
Copyright (C) 2013 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(ClassDiscovery)
Loading required package: cluster
Loading required package: oompaBase
> # want to test the bimodal index method
> set.seed(632984) # for reproducibility
> # start by generating a dataset with no bimodality
> nGenes <- 500
> nSamples <- 200
> temp <- matrix(rnorm(nGenes*nSamples), nrow=nGenes)
> # define the number of samples in the smaller group
> fracs <- rep(nSamples*seq(0.1, 0.5, by=0.1), each=20)
> # define the spread between the two means, per gene
> delta <- rnorm(length(fracs), 3,1)
> # now shift the means for the smaller group. This is
> # woefully inefficient.
> for (i in 1:length(fracs)) {
+   temp[i, 1:fracs[i]] <- temp[i, 1:fracs[i]] + delta[i]
+ }
> # now we compute the bimodal index
> bim <- bimodalIndex(temp)
1 .....
> summary(bim)
      mu1               mu2               sigma            delta       
 Min.   :-3.8769   Min.   :-0.01843   Min.   :0.6080   Min.   :0.4508  
 1st Qu.:-0.6671   1st Qu.: 0.41883   1st Qu.:0.7837   1st Qu.:1.1817  
 Median :-0.4517   Median : 0.61599   Median :0.8574   Median :1.5989  
 Mean   :-0.4747   Mean   : 1.01606   Mean   :0.8617   Mean   :1.7188  
 3rd Qu.:-0.2457   3rd Qu.: 0.99478   3rd Qu.:0.9329   3rd Qu.:2.0042  
 Max.   : 0.3974   Max.   : 5.19929   Max.   :1.1784   Max.   :5.0669  
       pi                 BI        
 Min.   :0.005767   Min.   :0.2254  
 1st Qu.:0.448965   1st Qu.:0.5443  
 Median :0.514235   Median :0.7122  
 Mean   :0.530111   Mean   :0.7779  
 3rd Qu.:0.620507   3rd Qu.:0.9023  
 Max.   :0.967602   Max.   :2.4549  
> summary(bim[1:100,])
      mu1                  mu2             sigma            delta       
 Min.   :-1.5041446   Min.   :0.3125   Min.   :0.6895   Min.   :0.6092  
 1st Qu.:-0.1165865   1st Qu.:1.9605   1st Qu.:0.9329   1st Qu.:2.0894  
 Median :-0.0009222   Median :2.7985   Median :0.9690   Median :2.7491  
 Mean   :-0.0389630   Mean   :2.7562   Mean   :0.9814   Mean   :2.8430  
 3rd Qu.: 0.0757796   3rd Qu.:3.4738   3rd Qu.:1.0323   3rd Qu.:3.4193  
 Max.   : 0.3974059   Max.   :5.1993   Max.   :1.1784   Max.   :5.0669  
       pi                BI        
 Min.   :0.07647   Min.   :0.2993  
 1st Qu.:0.53710   1st Qu.:0.8273  
 Median :0.66417   Median :1.2235  
 Mean   :0.66274   Mean   :1.2352  
 3rd Qu.:0.79298   3rd Qu.:1.5702  
 Max.   :0.95278   Max.   :2.4549  
> head(bim)
          mu1       mu2     sigma    delta        pi        BI
1  0.07499961 2.7749248 1.0916246 2.473309 0.9236375 0.6568547
2 -0.35139258 0.7517084 0.8841638 1.247621 0.5532722 0.6202595
3 -0.10734423 2.1999349 0.9760219 2.363962 0.8396970 0.8673066
4  0.03692683 2.5139923 0.9386465 2.638976 0.9022877 0.7835785
5  0.18375963 3.2808590 1.0251445 3.021134 0.9527834 0.6407884
6 -0.11505360 2.9888609 1.0187857 3.046680 0.9139701 0.8543141
> round(bim[1:100,], digits=6)
          mu1      mu2    sigma    delta       pi       BI
1    0.075000 2.774925 1.091625 2.473309 0.923637 0.656855
2   -0.351393 0.751708 0.884164 1.247621 0.553272 0.620260
3   -0.107344 2.199935 0.976022 2.363962 0.839697 0.867307
4    0.036927 2.513992 0.938646 2.638976 0.902288 0.783578
5    0.183760 3.280859 1.025145 3.021134 0.952783 0.640788
6   -0.115054 2.988861 1.018786 3.046680 0.913970 0.854314
7    0.003722 2.769845 1.008871 2.741800 0.899308 0.825062
8    0.099975 2.490578 0.906908 2.635993 0.889083 0.827780
9   -0.107756 1.557708 0.927083 1.796456 0.843116 0.653355
10   0.030513 4.682197 0.959156 4.849769 0.897738 1.469442
11  -0.418315 0.723227 0.859155 1.328680 0.505995 0.664292
12  -0.017920 2.612804 1.056066 2.491060 0.902803 0.737915
13  -0.416235 0.997259 0.791726 1.785331 0.676709 0.835058
14  -0.138183 1.060886 0.834774 1.436399 0.745366 0.625775
15   0.104277 4.702186 0.956198 4.808530 0.897815 1.456461
16  -0.101760 3.924495 0.952428 4.227361 0.897868 1.280135
17   0.191685 3.205723 1.077089 2.798320 0.949556 0.612439
18  -0.162862 2.115949 0.933144 2.442079 0.862941 0.839855
19  -0.002242 3.853957 1.125894 3.425012 0.913208 0.964244
20  -0.082591 0.587064 1.099301 0.609164 0.592337 0.299343
21  -0.112796 2.896481 0.885433 3.398649 0.801540 1.355517
22   0.032602 3.361958 0.980402 3.395910 0.784629 1.395990
23   0.015585 5.199286 1.089681 4.757081 0.805774 1.881919
24   0.013801 4.023443 1.040768 3.852579 0.776248 1.605591
25  -0.004715 2.565329 0.932359 2.756496 0.828465 1.039132
26   0.055840 4.366258 0.953440 4.520911 0.791796 1.835594
27   0.047882 2.877125 0.936492 3.021108 0.796529 1.216237
28  -0.190556 1.336719 0.899873 1.697211 0.666538 0.800150
29   0.114449 2.813249 1.057759 2.551431 0.849743 0.911686
30  -0.156392 1.407094 1.083107 1.443519 0.700491 0.661194
31   0.057686 2.917118 0.936789 3.052377 0.797997 1.225512
32  -0.089073 0.903033 0.917289 1.081564 0.613326 0.526708
33  -0.023864 2.383809 1.008962 2.386286 0.762212 1.015910
34   0.035010 2.066677 0.968551 2.097634 0.820626 0.804790
35   0.000398 2.492708 0.912289 2.731931 0.779317 1.132951
36  -0.005488 3.580066 1.075762 3.333036 0.791584 1.353799
37  -0.221081 1.636732 0.932956 1.991320 0.692055 0.919280
38  -0.027499 2.781495 1.068781 2.628222 0.823508 1.001980
39   0.069329 2.079429 0.987128 2.036312 0.939291 0.486264
40   0.161641 3.918459 1.051741 3.572000 0.828239 1.347261
41   0.144236 3.628028 0.928926 3.750343 0.691806 1.731710
42   0.032106 4.075455 0.946108 4.273664 0.702155 1.954394
43  -0.195207 1.681868 0.895471 2.096188 0.600218 1.026825
44  -0.196776 2.326882 0.859903 2.934817 0.645852 1.403589
45   0.004461 3.465388 0.974406 3.551833 0.712629 1.607332
46  -0.186412 3.126635 0.897733 3.690457 0.679178 1.722678
47   0.015647 1.715346 0.980515 1.733476 0.651852 0.825799
48  -0.058556 4.419073 1.099703 4.071670 0.698202 1.869052
49   0.014681 2.786898 1.178355 2.352618 0.661804 1.113013
50  -0.002318 4.509531 0.967825 4.661843 0.697916 2.140538
51   0.051639 4.027563 0.979017 4.061138 0.718110 1.827187
52  -0.200790 2.486341 0.968232 2.775296 0.686932 1.287020
53  -0.078335 1.206856 0.990669 1.297297 0.561989 0.643644
54   0.112054 2.647923 0.947877 2.675315 0.680127 1.247839
55  -0.210770 3.027790 1.012210 3.199492 0.677793 1.495193
56  -0.121185 3.758541 0.976937 3.971317 0.679953 1.852597
57   0.095672 3.100716 0.965380 3.112811 0.713980 1.406676
58  -0.105785 2.879150 0.967074 3.086563 0.668401 1.453116
59  -1.504145 0.312471 0.906451 2.004098 0.076474 0.532599
60   0.218843 5.078223 0.959051 5.066861 0.706250 2.307848
61  -0.173512 1.721129 0.993389 1.907249 0.614436 0.928312
62   0.152976 2.911065 0.959295 2.875120 0.633713 1.385202
63  -0.160306 1.225380 0.857334 1.616275 0.538266 0.805767
64  -0.057750 4.523079 0.918582 4.986846 0.587500 2.454946
65   0.045700 2.470987 0.906267 2.676129 0.630001 1.292046
66  -0.176811 1.967384 0.871051 2.461617 0.561585 1.221437
67   0.018286 2.243260 1.112902 1.999255 0.549127 0.994791
68   0.260981 3.045281 1.023290 2.720931 0.628735 1.314599
69  -0.142277 3.052995 0.934989 3.417443 0.612617 1.664816
70  -0.401384 1.173823 0.689542 2.284426 0.506118 1.142127
71   0.125397 3.281744 1.064619 2.964767 0.597858 1.453715
72   0.046920 3.886737 1.048851 3.660975 0.592012 1.799226
73  -0.097708 2.467693 0.904995 2.834712 0.578464 1.399795
74  -0.585654 0.994188 1.100155 1.436018 0.202972 0.577584
75  -0.007348 1.874380 0.909553 2.068849 0.646122 0.989266
76   0.111614 1.416089 1.176441 1.108831 0.473398 0.553630
77   0.153313 1.086609 0.971458 0.960717 0.493114 0.480313
78   0.078120 4.966627 1.025487 4.767009 0.598620 2.336681
79  -0.172690 2.183479 1.053600 2.236303 0.509512 1.117949
80   0.030113 3.429809 0.960610 3.539101 0.615395 1.721779
81   0.041647 3.384506 0.997422 3.351499 0.495778 1.675690
82  -0.058421 3.446225 1.029429 3.404456 0.479766 1.700834
83   0.005815 3.335819 1.086002 3.066297 0.504261 1.533093
84  -0.183686 1.386331 0.951792 1.649538 0.500702 0.824768
85   0.083540 2.284177 0.946743 2.324428 0.533588 1.159589
86   0.175373 3.162766 0.952976 3.134805 0.514622 1.566732
87  -0.164090 1.939949 1.027947 2.046835 0.375054 0.990948
88   0.138578 4.627982 1.005682 4.464040 0.497922 2.232001
89  -0.045159 3.498926 1.121014 3.161500 0.504220 1.580694
90   0.223650 4.360266 0.978326 4.228262 0.498199 2.114117
91   0.118402 2.810047 1.106090 2.433477 0.503211 1.216713
92   0.252169 3.499824 1.106457 2.935185 0.500235 1.467593
93   0.113599 4.039653 0.984499 3.987872 0.513468 1.993212
94  -0.106543 0.886330 0.968263 1.025416 0.564168 0.508468
95   0.397406 3.080601 1.071511 2.504122 0.583938 1.234292
96  -0.292534 1.634466 0.947673 2.033402 0.462791 1.013882
97  -0.057059 4.335099 0.925205 4.747226 0.504748 2.373506
98   0.125931 2.518438 0.969541 2.467669 0.494903 1.233771
99   0.054241 3.412753 1.007885 3.332239 0.483523 1.665215
100 -0.073158 2.392263 0.932841 2.642916 0.467846 1.318723
> 
> proc.time()
   user  system elapsed 
   7.20    0.07    7.31 
