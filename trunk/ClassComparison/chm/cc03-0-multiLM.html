<html><head><title>The MultiLinearModel Class</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>MultiLinearModel-class(ClassComparison)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   MultiLinearModel">
<param name="keyword" value="R:   multiTukey">
<param name="keyword" value="R:   MultiLinearModel-class">
<param name="keyword" value="R:   anova,MultiLinearModel-method">
<param name="keyword" value="R:   hist,MultiLinearModel-method">
<param name="keyword" value="R:   plot,MultiLinearModel,missing-method">
<param name="keyword" value="R:   plot,MultiLinearModel,ANY-method">
<param name="keyword" value="R:   summary,MultiLinearModel-method">
<param name="keyword" value=" The MultiLinearModel Class">
</object>


<h2>The MultiLinearModel Class</h2>


<h3>Description</h3>

<p>
Class to fit multiple (row-by-row) linear (fixed-effects) models on
microarray or proteomics data.
</p>


<h3>Usage</h3>

<pre>
MultiLinearModel(form, clindata, arraydata)
## S4 method for signature 'MultiLinearModel':
summary(object, ...)
## S4 method for signature 'MultiLinearModel':
hist(x, xlab='F Statistics', main=NULL, ...)
## S4 method for signature 'MultiLinearModel, missing':
plot(x, ylab='F Statistics', ...)
## S4 method for signature 'MultiLinearModel, ANY':
plot(x, y, xlab='F Statistics',
 ylab=deparse(substitute(y)), ...)
## S4 method for signature 'MultiLinearModel':
anova(object, ob2, ...)
multiTukey(object, alpha)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>form</code></td>
<td>
A <code>formula</code> object specifying the linear model</td></tr>
<tr valign="top"><td><code>clindata</code></td>
<td>
Either a data frame of "clinical" or other
covariates or an <code><a onclick="findlink('Biobase', 'class.ExpressionSet.html')" style="text-decoration: underline; color: blue; cursor: hand">ExpressionSet</a></code>. </td></tr>
<tr valign="top"><td><code>arraydata</code></td>
<td>
A matrix or data frame of values to be explained by
the model.  If <code>clindata</code> is an <code>ExpressionSet</code>, then
<code>arraydata</code> can be omitted, since it is assumed to be part of
the <code>ExpressionSet</code>.</td></tr>
<tr valign="top"><td><code>object</code></td>
<td>
A <code>MultiLinearModel</code> object</td></tr>
<tr valign="top"><td><code>ob2</code></td>
<td>
Another <code>MultiLinearModel</code> object</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
A <code>MultiLinearModel</code> object</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
A numeric vector</td></tr>
<tr valign="top"><td><code>xlab</code></td>
<td>
Label for the x-axis</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
Label for the y-axis</td></tr>
<tr valign="top"><td><code>main</code></td>
<td>
Graph title</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
Optional graphical or other parameters to generic functions</td></tr>
<tr valign="top"><td><code>alpha</code></td>
<td>
A real number between 0 and 1; the significance level for
the Tukey test.</td></tr>
</table>

<h3>Value</h3>

<p>
The <code>anova</code> method returns a data frame.  The rows in the data
frame correpsonds to the rows in the <code>arraydata</code> object that was
used to construct the <code>MultiLinearModel</code> objects.  The first
column contains the F-statistics and the second column contains the
p-values.
<br>
The <code>multiTukey</code> function returns a vector whosem length equals
the number of rows in the <code>arraydata</code> object used to construct
the <code>MultiLinearModel</code>. Assuming that the overall F-test was
significant, differences in group means (in each data row) larger than
this value are significant by Tukey's test for honestly significant
difference. (Of course, that statement is incorrect, since we haven't
fully corrected for multiple testing. Our standard practice is to take
the p-values from the row-by-row F-tests and evaluate them using the
beta-uniform mixture model (see <code><a href="cc00-0-bum.html">Bum</a></code>). For the rows that
correspond to models whose p-values are smaller than the <code>Bum</code>
cutoff, we simply use the Tukey HSD values without further
modification.)</p>

<h3>Creating Objects</h3>

<p>
Objects should be created by calling the <code>MultiLinearModel</code>
function.  The first argument is a <code><a onclick="findlink('stats', 'formula.html')" style="text-decoration: underline; color: blue; cursor: hand">formula</a></code> specifying
the linear model, in the same manner that it would be passed to
<code><a onclick="findlink('stats', 'lm.html')" style="text-decoration: underline; color: blue; cursor: hand">lm</a></code>.  We will fit the linear model separately for each
row in the <code>arraydata</code> matrix.  Rows of <code>arraydata</code> are
attached to the <code>clindata</code> data frame and are always referred to
as "Y" in the formulas. In particular, this implies that
<code>clindata</code> can not include a column already called "Y".  Further,
the implementation only works if "Y" is the response variable in the
model.
</p>


<h3>Multiple linear models with "ExpressionSet" objects</h3>

<p>
The BioConductor packages uses an <code>ExpressionSet</code> to combine microarray
data and clinical covariates (known in their context as
<code><a onclick="findlink('Biobase', 'phenoData.html')" style="text-decoration: underline; color: blue; cursor: hand">phenoData</a></code> objects) into a single structure.
You can call <code>MultiLinearModel</code> using an <code>ExpressionSet</code> object
for the <code>clindata</code> argument.  In this case, the function extracts
the <code>phenoData</code> slot of the <code>ExpressionSet</code> to use for the
clinical covariates, and extracts the <code>exprs</code> slot of the
<code>ExpressionSet</code> object to use for the array data.
</p>


<h3>Slots</h3>

<dl>
<dt><code>call</code>:</dt><dd>A <code>call</code> object describing how the object
was constructed. </dd>
<dt><code>model</code>:</dt><dd>The <code>formula</code> object specifying the linear
model. </dd>
<dt><code>F.statistics</code>:</dt><dd>A numeric vector of F-statistics
comparing the linear model to the null model. </dd>
<dt><code>p.values</code>:</dt><dd>A numeric vector containing the p-values
associated to the F-statistics.</dd>
<dt><code>coefficients</code>:</dt><dd>A <code>matrix</code> of the coefficients in
the linear models. </dd>
<dt><code>predictions</code>:</dt><dd>A <code>matrix</code> of the (Y-hat) values
predicted by the models. </dd>
<dt><code>sse</code>:</dt><dd>A numeric vector of the sum of squared error
terms from fitting the models. </dd>
<dt><code>ssr</code>:</dt><dd>A numeric vector of the sum of squared
regression terms from the model. </dd>
<dt><code>df</code>:</dt><dd>A numeric vector (of length two) containing the
degrees of freedom for the F-tests.</dd>
</dl>

<h3>Methods</h3>

<dl>
<dt>summary(object, ...)</dt><dd>Write out a summary of the object.</dd>
<dt>hist(x, xlab='F Statistics', main=NULL, ...)</dt><dd>Create a
histogram of the F-statistics.</dd>
<dt>plot(x, ylab='F Statistics', ...)</dt><dd>Plot the F-statistics as a
function of the row index.</dd>
<dt>plot(x, y, xlab='F Statistics', ylab=deparse(substitute(y)),
...)</dt><dd>Plot the F-statistics against the numeric vector <code>y</code>.</dd>
<dt>anova(object, ob2, ...)</dt><dd>Perform row-by-row F-tests comparing
two different linear models.</dd>
</dl>

<h3>Details</h3>

<p>
The <code>MultiLinearModel</code> constructor computes row-by-row F-tests
comparing each linear model to the null model Y ~ 1.  In many
instances, one wishes to use an F-test to compare two different linear
models. For instance, many standard applications of analysis of
variance (ANOVA) can be described using sucha compoarison between two
different linear models. The <code>anova</code> method for the
<code>MultiLinearModel</code> class performs row-by-row F-tests comparing
two competing linear models.
</p>
<p>
The implementation of <code>MultiLinearModel</code> does not take the naive
approach of using either <code><a onclick="findlink('base', 'apply.html')" style="text-decoration: underline; color: blue; cursor: hand">apply</a></code> or a
<code><a onclick="findlink('base', 'Control.html')" style="text-decoration: underline; color: blue; cursor: hand">for</a></code>-loop to attach rows one at a time and fit separate
linear models. All the models are actually fit simultaneously by a
series of matrix operations, which greatly reduces the amount of time
needed to compute the models. The constraint on the column names in
<code>clindata</code> still holds, since one row is attached to allow
<code><a onclick="findlink('stats', 'model.matrix.html')" style="text-decoration: underline; color: blue; cursor: hand">model.matrix</a></code> to determine the contrasts matrix.
</p>


<h3>Author(s)</h3>

<p>
Kevin R. Coombes &lt;kcoombes@mdanderson.org&gt;
</p>


<h3>See Also</h3>

<p>
<code><a href="cc01-0-multiT.html">MultiTtest</a></code>, <code><a href="cc02-0-multiWil.html">MultiWilcoxonTest</a></code>,
<code><a href="cc00-0-bum.html">Bum</a></code>, <code><a onclick="findlink('stats', 'lm.html')" style="text-decoration: underline; color: blue; cursor: hand">lm</a></code>, <code><a onclick="findlink('stats', 'anova.html')" style="text-decoration: underline; color: blue; cursor: hand">anova</a></code>.
</p>


<h3>Examples</h3>

<pre>
ng &lt;- 10000
ns &lt;- 50
dat &lt;- matrix(rnorm(ng*ns), ncol=ns)
cla &lt;- factor(rep(c('A', 'B'), 25))
cla2 &lt;- factor(rep(c('X', 'Y', 'Z'), times=c(15, 20, 15)))
covars &lt;- data.frame(Grade=cla, Stage=cla2)
res &lt;- MultiLinearModel(Y ~ Grade + Stage, covars, dat)
summary(res)
hist(res, breaks=101)
plot(res)
plot(res, res@p.values)

graded &lt;- MultiLinearModel(Y ~ Grade, covars, dat)
summary(graded)

hist(graded@p.values, breaks=101)
hist(res@p.values, breaks=101)

oop &lt;- anova(res, graded)
hist(oop$p.values, breaks=101)

# cleanup
rm(ng, ns, dat, cla, cla2, covars, res, graded, oop)
</pre>

<script Language="JScript">
function findlink(pkg, fn) {
var Y, link;
Y = location.href.lastIndexOf("\\") + 1;
link = location.href.substring(0, Y);
link = link + "../../" + pkg + "/chtml/" + pkg + ".chm::/" + fn;
location.href = link;
}
</script>


<hr><div align="center">[Package <em>ClassComparison</em> version 2.5.0 <a href="00Index.html">Index]</a></div>

</body></html>
