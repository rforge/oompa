<html><head><title>The SmoothTtest Class</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>SmoothTtest-class(ClassComparison)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   SmoothTtest">
<param name="keyword" value="R:   SmoothTtest-class">
<param name="keyword" value="R:   as.data.frame,SmoothTtest-method">
<param name="keyword" value="R:   plot,SmoothTtest,missing-method">
<param name="keyword" value="R:   summary,SmoothTtest-method">
<param name="keyword" value=" The SmoothTtest Class">
</object>


<h2>The SmoothTtest Class</h2>


<h3>Description</h3>

<p>
Implements the smooth t-test for differential expression as developed
by Baggerly and Coombes.
</p>


<h3>Usage</h3>

<pre>
SmoothTtest(stats, aname = 'Group One', bname = 'Group Two',
 name = paste(aname, 'vs.', bname))
## S4 method for signature 'SmoothTtest':
as.data.frame(x, row.names=NULL, optional=FALSE)
## S4 method for signature 'SmoothTtest':
summary(object, ...)
## S4 method for signature 'SmoothTtest, missing':
plot(x, folddiff=3, goodflag=2, badch=4, ccl=0,
 name=x@name, pch='.', xlab='log intensity', ylab='log ratio', ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>stats</code></td>
<td>
An object of the <code><a href="cc07-0-TwoGroupStats-class.html">TwoGroupStats</a></code> class.</td></tr>
<tr valign="top"><td><code>aname</code></td>
<td>
A character string; the name of the second group</td></tr>
<tr valign="top"><td><code>bname</code></td>
<td>
A character string; the name of the second group</td></tr>
<tr valign="top"><td><code>name</code></td>
<td>
A character string; the name of this object</td></tr>
<tr valign="top"><td><code>object</code></td>
<td>
A <code>SmoothTtest</code> object</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
A <code>SmoothTtest</code> object</td></tr>
<tr valign="top"><td><code>row.names</code></td>
<td>
See the base version of <code><a onclick="findlink('base', 'as.data.frame.html')" style="text-decoration: underline; color: blue; cursor: hand">as.data.frame.default</a></code></td></tr>
<tr valign="top"><td><code>optional</code></td>
<td>
See the base version of
<code><a onclick="findlink('base', 'as.data.frame.html')" style="text-decoration: underline; color: blue; cursor: hand">as.data.frame.default</a></code></td></tr>
<tr valign="top"><td><code>folddiff</code></td>
<td>
A real number; the level of fold difference considered
large enough to be indicated in the plots.</td></tr>
<tr valign="top"><td><code>goodflag</code></td>
<td>
A real number; the level (in standard deviation units)
of the smooth t-statistic     considered large enough to be
indicated in the plot.</td></tr>
<tr valign="top"><td><code>badch</code></td>
<td>
A real number; the level of variability in single groups
considered large enough to be worrisome. See the <code>multiple</code>
argument to the <code>plot</code> method in the <code><a href="cc08-0-SingleGroup-class.html">SingleGroup</a></code>
class.</td></tr>
<tr valign="top"><td><code>ccl</code></td>
<td>
A list containing objects of the
<code><a onclick="findlink('PreProcess', 'ColorCoding.html')" style="text-decoration: underline; color: blue; cursor: hand">ColorCoding</a></code> class. If left at its default
value of zero, colors are chosen automatically.</td></tr>
<tr valign="top"><td><code>pch</code></td>
<td>
Default plotting character</td></tr>
<tr valign="top"><td><code>xlab</code></td>
<td>
Label for the x axis</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
Label for the y axis</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
</td></tr>
</table>
<p>
 {The usual extra parameters to generic or plotting routines}</p>

<h3>Details</h3>

<p>
In 2001 and 2002, Baggerly and Coombes developed the smooth t-test for
finding differentially expressed genes in microarray data.  Along with
many others, they began by log-transforming the data as a reasonable
step in the direction of variance stabilization.  They observed,
however, that the gene-by-gene standard deviations still seemed to
vary in a systematic way as a function of the mean log intensity.  By
borrowing strenght across genes and using <code><a onclick="findlink('stats', 'loess.html')" style="text-decoration: underline; color: blue; cursor: hand">loess</a></code> to fit
the observed standard deviations as a function of the mean, one
presumably got a better estimate of the true standard deviation.
</p>
<p>
These smooth estimates are computed for each of two groups of samples
being compared.  They are then combined (gene-by-gene using the usual
univariate formulas) to compute pooled "smooth" estimates of the standard
deviation.  These smooth estimates are then used in gene-by-gene
t-tests.
</p>
<p>
The interesting question then arises of how to compute and interpret
p-values associated to these individual tests.  The liberal
argument asserts that, because smoothing uses data from hundreds
of measurements to estiamte the standard deviation, it can effectively
be treated as "known" in the t-tests, which should thus be compared
against the normal distribution.  A conservative argument claims
that the null distribution should still be the t-distribution with the
degrees of freedom determined in the usual way by the number of
samples.  The truth probably lies somewhere in between, and is
probably best approximated by some kind of permutation test.  In this
implementation, we take the coward's way out and don't provide any of
those alternatives. You have to extract the t-statistics (from the
<code>smooth.t.statistics</code> slot of the object) and compute your own
p-values in your favorite way.  If you base the computations on a
theoretical model rather than a permutation test, then the
<code><a href="cc00-0-bum.html">Bum</a></code> class provides a convenient way to account for
multiple testing.
</p>


<h3>Creating Objects</h3>

<p>
In practice, users will first use a data frame and a classification
vector (or an <code>ExpressionSet</code>) to construct an object of the
<code><a href="cc07-0-TwoGroupStats-class.html">TwoGroupStats</a></code> object.  This object can then be handed
directly to the <code>SmoothTtest</code> function to perform the smooth
t-test.
</p>


<h3>Slots</h3>

<dl>
<dt><code>one</code>:</dt><dd>An object of the <code>SingleGroup</code> class
representing a loess smooth of standard deviation as a function of
the mean in the first group of samples.</dd>
<dt><code>two</code>:</dt><dd>An object of the <code>SingleGroup</code> class
representing a loess smooth of standard deviation as a function of
the mean in the second group of samples.</dd>
<dt><code>smooth.t.statistics</code>:</dt><dd>A numeric vector containing the
smooth t-statistics</dd>
<dt><code>fit</code>:</dt><dd>A data.frame containing two columns, <code>x</code> and
<code>y</code>, containing the smooth estimates of the pooled standard deviation</dd>
<dt><code>dif</code>:</dt><dd>A numeric vector of the differences in mean
values between the two groups</dd>
<dt><code>avg</code>:</dt><dd>A numeric vector of the overall mean value</dd>
<dt><code>aname</code>:</dt><dd>A character string; the name of the first group</dd>
<dt><code>bname</code>:</dt><dd>A character string; the name of the second group</dd>
<dt><code>name</code>:</dt><dd>A character string; the name of this object</dd>
<dt><code>stats</code>:</dt><dd>The <code>TwoGroupStats</code> object that was used
to create this object. </dd>
</dl>

<h3>Methods</h3>

<dl>
<dt>as.data.frame(x, row.names=NULL, optional=FALSE)</dt><dd>Convert the
object into a data frame suitable for printing or exporting.</dd>
<dt>summary(object, ...)</dt><dd>Write out a summary of the object.</dd>
<dt>plot(x, folddiff=3, goodflag=2, badch=4, ccl=0, name=x@name,
pch='.', xlab='log intensity', ylab='log ratio', ...)</dt><dd>Create a
set of six plots.  The first two plots are the QC plots from the
<code><a href="cc08-0-SingleGroup-class.html">SingleGroup</a></code> objects representing the two groups of
samples.  The third plot is a scatter plot comparing the means in
the two groups.  The fourth plot is Bland-Altman plot of the
overall mean against the difference in means (also known
colloquially as an M-vs-A plot).  The fifth plot is a histogram of
the smooth t-statistics.  The final plot is a scatter plot of the
smooth t-statistics as a function of the mean intensity. Colors in
the plots are controlled by the curent values of
<code><a onclick="findlink('PreProcess', 'semanticColors.html')" style="text-decoration: underline; color: blue; cursor: hand">COLOR.BORING</a></code>,
<code><a onclick="findlink('PreProcess', 'semanticColors.html')" style="text-decoration: underline; color: blue; cursor: hand">COLOR.SIGNIFICANT</a></code>,
<code><a onclick="findlink('PreProcess', 'semanticColors.html')" style="text-decoration: underline; color: blue; cursor: hand">COLOR.BAD.REPLICATE</a></code>,
<code><a onclick="findlink('PreProcess', 'semanticColors.html')" style="text-decoration: underline; color: blue; cursor: hand">COLOR.WORST.REPLICATE</a></code>,
<code><a onclick="findlink('PreProcess', 'semanticColors.html')" style="text-decoration: underline; color: blue; cursor: hand">COLOR.FOLD.DIFFERENCE</a></code>,
<code><a onclick="findlink('PreProcess', 'semanticColors.html')" style="text-decoration: underline; color: blue; cursor: hand">COLOR.CENTRAL.LINE</a></code>, AND
<code><a onclick="findlink('PreProcess', 'semanticColors.html')" style="text-decoration: underline; color: blue; cursor: hand">COLOR.CONFIDENCE.CURVE</a></code>.
</dd>
</dl>

<h3>Author(s)</h3>

<p>
Kevin R. Coombes &lt;kcoombes@mdanderson.org&gt;
</p>


<h3>References</h3>

<p>
Baggerly, K.A., Coombes, K.R., Hess, K.R., Stivers, D.N., Abruzzo,
L.V., Zhang, W.  Identifying differentially expressed genes in cDNA
microarray experiments.  J Comp Biol. 8:639-659, 2001.
</p>
<p>
Coombes, K.R., Highsmith, W.E., Krogmann, T.A., Baggerly, K.A.,
Stivers, D.N., Abruzzo, L.V.   Identifying and quantifying sources of
variation in microarray data using high-density cDNA membrane arrays.
J Comp Biol. 9:655-669, 2002.
</p>
<p>
Altman DG, Bland JM. Measurement in Medicine: the Analysis of Method
Comparison Studies. The Statistician, 1983; 32: 307-317.
</p>


<h3>See Also</h3>

<p>
<code><a href="cc00-0-bum.html">Bum</a></code>, <code><a href="cc01-0-multiT.html">MultiTtest</a></code>,
<code><a href="cc08-0-SingleGroup-class.html">SingleGroup</a></code>, <code><a href="cc07-0-TwoGroupStats-class.html">TwoGroupStats</a></code>.
</p>


<h3>Examples</h3>

<pre>
bogus &lt;- matrix(rnorm(30*1000, 8, 3), ncol=30, nrow=1000)
splitter &lt;- rep(FALSE, 30)
splitter[16:30] &lt;- TRUE
x &lt;- TwoGroupStats(bogus, splitter)
y &lt;- SmoothTtest(x)

opar &lt;- par(mfrow=c(2, 3), pch='.')
plot(y, badch=2, goodflag=1)
par(opar)

# cleanup
rm(bogus, splitter, x, y, opar)
</pre>

<script Language="JScript">
function findlink(pkg, fn) {
var Y, link;
Y = location.href.lastIndexOf("\\") + 1;
link = location.href.substring(0, Y);
link = link + "../../" + pkg + "/chtml/" + pkg + ".chm::/" + fn;
location.href = link;
}
</script>


<hr><div align="center">[Package <em>ClassComparison</em> version 2.5.0 <a href="00Index.html">Index]</a></div>

</body></html>
