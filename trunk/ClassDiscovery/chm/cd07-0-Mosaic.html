<html><head><title>The Mosaic Class</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>Mosaic(ClassDiscovery)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   Mosaic">
<param name="keyword" value="R:   Mosaic-class">
<param name="keyword" value="R:   plot,Mosaic,missing-method">
<param name="keyword" value="R:   pltree,Mosaic-method">
<param name="keyword" value="R:   summary,Mosaic-method">
<param name="keyword" value=" The Mosaic Class">
</object>


<h2>The Mosaic Class</h2>


<h3>Description</h3>

<p>
Produce &ldquo;Eisen&rdquo; plots of microarray or proteomics data.
</p>


<h3>Usage</h3>

<pre>
Mosaic(data, sampleMetric = "pearson", sampleLinkage = "average", geneMetric = "euclid", geneLinkage = "average", usecor = FALSE, center = FALSE, name = "My mosaic")

## S4 method for signature 'Mosaic':
pltree(x, colors, labels, ...)

## S4 method for signature 'Mosaic, missing':
plot(x, main=x@name, center=FALSE, limits=NULL,
 sampleColors=NULL, sampleClasses=NULL, geneColors=NULL, geneClasses=NULL, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>
Either a data frame or matrix with numeric values or an
<code><a onclick="findlink('Biobase', 'class.ExpressionSet.html')" style="text-decoration: underline; color: blue; cursor: hand">ExpressionSet</a></code> as defined
in the BioConductor tools for analyzing microarray data.</td></tr>
<tr valign="top"><td><code>sampleMetric</code></td>
<td>
Any valid distance metric that can be passed to the
<code><a href="cd01-0-distanceMatrix.html">distanceMatrix</a></code> function</td></tr>
<tr valign="top"><td><code>sampleLinkage</code></td>
<td>
Any valid linkage method that can be passed to the
<code><a onclick="findlink('stats', 'hclust.html')" style="text-decoration: underline; color: blue; cursor: hand">hclust</a></code> function</td></tr>
<tr valign="top"><td><code>geneMetric</code></td>
<td>
Any valid distance metric that can be passed to the
<code><a href="cd01-0-distanceMatrix.html">distanceMatrix</a></code> function</td></tr>
<tr valign="top"><td><code>geneLinkage</code></td>
<td>
Any valid linkage method that can be passed to the
<code><a onclick="findlink('stats', 'hclust.html')" style="text-decoration: underline; color: blue; cursor: hand">hclust</a></code> function</td></tr>
<tr valign="top"><td><code>center</code></td>
<td>
A logical flag; should the data rows be centered?</td></tr>
<tr valign="top"><td><code>usecor</code></td>
<td>
A logical flag; should the data rows be scaled to have
standard deviation one?</td></tr>
<tr valign="top"><td><code>name</code></td>
<td>
A character string; the name of this object.</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
A <code>Mosaic</code> object.</td></tr>
<tr valign="top"><td><code>colors</code></td>
<td>
An optional vector of character strings containing color
names to be used when labeling the trees in the dendrogram. If
provided, then the length should equal the number of columns in the
original data matrix.</td></tr>
<tr valign="top"><td><code>labels</code></td>
<td>
An optional vector of character strings used to label
the leaves in the dendrogram. If omitted, the column names are
used.</td></tr>
<tr valign="top"><td><code>main</code></td>
<td>
A character string; the plot title</td></tr>
<tr valign="top"><td><code>limits</code></td>
<td>
An numeric vector. If provided, the data is truncated
for display purposes, both above and below, at the minimum and
maximum values of <code>limits</code>.</td></tr>
<tr valign="top"><td><code>sampleColors</code></td>
<td>
An optional character vector containing colors
that will be used to label different sample types with a color bar
across the top of the heat map.</td></tr>
<tr valign="top"><td><code>sampleClasses</code></td>
<td>
A logical vector or factor used to classify the
samples into groups. Alternatively, an integer specifying the number
<code>k</code> of groups into which to cut the sample dendrogram.</td></tr>
<tr valign="top"><td><code>geneColors</code></td>
<td>
An optional character vector containing colors
that will be used to label different gene types with a color bar
along the side of the heat map.</td></tr>
<tr valign="top"><td><code>geneClasses</code></td>
<td>
A logical vector or factor used to classify the
genes into groups. Alternatively, an integer specifying the number
<code>k</code> of groups into which to cut the gene dendrogram.</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
Additional parameters for <code>heatmap</code>.</td></tr>
</table>

<h3>Details</h3>

<p>
One of the earliest papers in the microaray literature used
independent clustering of the genes (rows) and samples (columns) to
produce dendrograms that were plotted along with a red-green heat map
of the centered expression values. Since that time, literally thousand
of additional papers have published variations on these red-green
images. R includes a function, <code><a onclick="findlink('stats', 'heatmap.html')" style="text-decoration: underline; color: blue; cursor: hand">heatmap</a></code> that builds such
figures.  However, that function is general purpose and has numerous
optional parameters to tweak the display. The purpose of the
<code>Mosaic</code> class is to provide a simplified object-oriented wrapper
around <code><a onclick="findlink('stats', 'heatmap.html')" style="text-decoration: underline; color: blue; cursor: hand">heatmap</a></code>, which as a side benefit allows us to
keep track of the distance metrics and linkage rules that were used to
produce the resulting figure.
</p>


<h3>Value</h3>

<p>
The <code>Mosaic</code> function constructs and returns a valid object of
the <code>Mosaic</code> class.</p>

<h3>Objects from the Class</h3>

<p>
Objects should be created with the <code>Mosaic</code> function.
</p>


<h3>Slots</h3>

<dl>
<dt><code>data</code>:</dt><dd>The <code>matrix</code> contaiing the numerical data </dd>
<dt><code>samples</code>:</dt><dd>A dendrogram of class <code>hclust</code> produced
by clustering the biological samples (columns of <code>data</code>). </dd>
<dt><code>genes</code>:</dt><dd>A dendrogram of class <code>hclust</code> produced by
clustering the genes (columns of <code>data</code>).</dd>
<dt><code>sampleMetric</code>:</dt><dd>A <code>character</code> string; the distance
metric used to cluster the samples. </dd>
<dt><code>sampleLinkage</code>:</dt><dd>A <code>character</code> string; the linkage
rule used to cluster the samples. </dd>
<dt><code>geneMetric</code>:</dt><dd>A <code>character</code> string; the distance
metric used to cluster the genes. </dd>
<dt><code>geneLinkage</code>:</dt><dd>A <code>character</code> string; the linkage
rule used to cluster the genes. </dd>
<dt><code>call</code>:</dt><dd>An object of class <code>call</code> recording how the
object was constructed. </dd>
<dt><code>name</code>:</dt><dd>A <code>character</code> string; the name of this object. </dd>
</dl>

<h3>Methods</h3>

<dl>
<dt>plot</dt><dd><code>signature(x = Mosaic, y = missing)</code>: Produce the
&ldquo;Eisen&rdquo; plot, using <code><a onclick="findlink('stats', 'heatmap.html')" style="text-decoration: underline; color: blue; cursor: hand">heatmap</a></code>. </dd>
<dt>pltree</dt><dd><code>signature(x = Mosaic)</code>: Plot the sample class
dendrogram in the object. </dd>
<dt>summary</dt><dd><code>signature(object = Mosaic)</code>: Write out a
summary of the object. </dd>
</dl>

<h3>Author(s)</h3>

<p>
Kevin R. Coombes &lt;kcoombes@mdanderson.org&gt;
</p>


<h3>References</h3>

<p>
Eisen MB, Spellman PT, Brown PO, Botstein D. Cluster analysis and
display of genome-wide expression patterns. Proc Natl Acad Sci U S
A. 1998 Dec 8;95(25):14863-8.
</p>


<h3>See Also</h3>

<p>
<code><a onclick="findlink('stats', 'heatmap.html')" style="text-decoration: underline; color: blue; cursor: hand">heatmap</a></code>, <code><a onclick="findlink('stats', 'hclust.html')" style="text-decoration: underline; color: blue; cursor: hand">hclust</a></code>, <code><a onclick="findlink('stats', 'cutree.html')" style="text-decoration: underline; color: blue; cursor: hand">cutree</a></code>
</p>


<h3>Examples</h3>

<pre>
# simulate data from three different sample groups
d1 &lt;- matrix(rnorm(100*10, rnorm(100, 0.5)), nrow=100, ncol=10, byrow=FALSE)
d2 &lt;- matrix(rnorm(100*10, rnorm(100, 0.5)), nrow=100, ncol=10, byrow=FALSE)
d3 &lt;- matrix(rnorm(100*10, rnorm(100, 0.5)), nrow=100, ncol=10, byrow=FALSE)
dd &lt;- cbind(d1, d2, d3)
kind &lt;- factor(rep(c('red', 'green', 'blue'), each=10))

# prepare the Mosaic object
m &lt;- Mosaic(dd, sampleMetric='pearson', geneMetric='spearman', center=TRUE, usecor=TRUE)
summary(m)

# The default plot with red-green color map
plot(m, col=redgreen(64))

# change to a blue-yellow color map, and mark the four top splits in the sample
# direction with a color bar along the top
plot(m, col=blueyellow(128), sampleClasses=4,
     sampleColors=c('red', 'green', 'blue', 'black'))

# This time, mark the three classes that we know are there
plot(m, col=blueyellow(128), sampleClasses=kind,
     sampleColors=c('red', 'green', 'blue'))

plot(m, col=blueyellow(128), geneClasses=3, geneColors=c('red', 'green', 'black'))

# In addition, mark the top 5 splits in the gene dendrogram
plot(m, col=blueyellow(128),
     sampleClasses=kind, sampleColors=c('red', 'green', 'black'),
     geneClasses=5, geneColors=c('cyan', 'magenta', 'royalblue', 'darkgreen', 'orange'))

# plot the sample dendrogram by itself
cols &lt;- as.character(kind)
pltree(m, labels=1:30, colors=cols)

# cleanup
rm(d1, d2, d3, dd, kind, cols, m)
</pre>

<script Language="JScript">
function findlink(pkg, fn) {
var Y, link;
Y = location.href.lastIndexOf("\\") + 1;
link = location.href.substring(0, Y);
link = link + "../../" + pkg + "/chtml/" + pkg + ".chm::/" + fn;
location.href = link;
}
</script>


<hr><div align="center">[Package <em>ClassDiscovery</em> version 2.7.0 <a href="00Index.html">Index]</a></div>

</body></html>
